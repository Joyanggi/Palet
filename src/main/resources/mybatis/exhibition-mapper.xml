<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
   <mapper namespace="Exhibition">
  	<insert id="exhibitionInsert">
  		insert into exhibition values(exhibition_seq.nextval, #{e_name},#{start_date},#{end_date},default,#{e_price},#{e_period})
  		<selectKey order="AFTER" keyProperty="e_num" resultType="int">
			select exhibition_seq.currval from dual
		</selectKey>
  	</insert>
    
    <select id="exhibitionSelectByPage" resultType="Trillion.Palet.DTO.ExhibitionDTO">
  		select * from (select row_number() over(order by e_num desc) line, exhibition.* from exhibition) where line between #{start} and #{end}
  		<trim prefix="order by">
  			<if test="order == 'line'">line</if>
  			<if test="order == 'e_num'">e_num</if>
	  		<if test="order == 'e_name'">e_name</if>
	  		<if test="order == 'start_date'">start_date</if>
	  		<if test="order == 'end_date'">end_date desc</if>
	  		<if test="order == 'e_price'">e_price</if>
  			<if test="order == 'e_period'">e_period</if>
  			<if test="order == 'sales_count'">sales_count</if>
  		</trim>
  	</select>
  	
  	<select id="getExhibitionTotalCount" resultType="int">
  		select count(*) from exhibition
  	</select>
  	
  	<delete id="exhibitionCheckDelete">
  		delete from exhibition where e_num = #{value}
  	</delete>
  	
  	<update id="exhibitionCheckUpdate">
  		update exhibition set e_period = #{e_period} where e_num = #{e_num}
  	</update>
  	
  	<select id="exhibitionSelectAll" resultType="Trillion.Palet.DTO.ExhibitionDTO">
  		select * from exhibition
  	</select>
  	
  	<select id="exhibitionBestSeller" resultType="Trillion.Palet.DTO.ExhibitionDTO">
  		select * from (select * from exhibition order by sales_count desc) where rownum=1
  	</select>
  	
  	<select id="getnowexhibion" resultType="Trillion.Palet.DTO.ExhibitionDTO">
  		select * from exhibition where e_num = #{e_num}
  	</select>
  	
  </mapper>